import{r as o,j as e,u as p,H as f,L as h}from"./app-BpbEyoxA.js";import{A as w}from"./AuthenticatedLayout-eYnlr3pS.js";import{C as n}from"./Currency-CETg0ZwZ.js";import"./transition-GXVTtJgq.js";import"./HelpInjector-BdYANK49.js";import"./InfoIcon-BKj8MgZu.js";function v({data:a=[],size:x=180}){const[i,s]=o.useState(null),l=o.useMemo(()=>a.reduce((d,t)=>d+Math.max(0,Number(t.value||0)),0),[a]),r=o.useMemo(()=>{let d=0;return a.map(t=>{const g=Math.max(0,Number(t.value||0)),m=l>0?g/l:0,b=d,j=d+m;return d=j,{...t,pct:m,start:b,end:j}})},[a,l]),u=o.useMemo(()=>l===0||r.length===0?"conic-gradient(#eee 0 360deg)":`conic-gradient(${r.map((t,g)=>{const m=Math.round(t.start*360),b=Math.round(t.end*360);return`${t.color} ${m}deg ${b}deg`}).join(",")})`,[r,l]),c=x;return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"relative mx-auto rounded-full shadow-inner",style:{width:c,height:c,backgroundImage:u},"aria-label":"Pie chart",children:e.jsx("div",{className:"absolute inset-0 m-auto rounded-full bg-white",style:{width:c*.6,height:c*.6}})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:r.map((d,t)=>e.jsxs("div",{onMouseEnter:()=>s(t),onMouseLeave:()=>s(null),className:`flex items-center gap-2 rounded border px-2 py-1 ${i===t?"bg-gray-50":""}`,children:[e.jsx("span",{className:"inline-block h-3 w-3 rounded",style:{backgroundColor:d.color}}),e.jsx("div",{className:"flex-1 text-sm text-gray-700 truncate",title:d.label,children:d.label}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:l>0?`${Math.round(d.pct*100)}%`:"0%"})]},t))})]})}function N({data:a=[]}){const[x,i]=o.useState(null),s=o.useMemo(()=>Math.max(0,...a.map(l=>Math.abs(Number(l.value)||0))),[a]);return e.jsx("div",{className:"flex flex-col gap-2",children:a.map((l,r)=>{const u=Math.abs(Number(l.value)||0),c=s>0?u/s*100:0;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-28 truncate text-sm text-gray-700",title:l.label,children:l.label}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{onMouseEnter:()=>i(r),onMouseLeave:()=>i(null),className:"h-3 rounded bg-gray-100",children:e.jsx("div",{className:`h-3 rounded ${x===r?"opacity-90":"opacity-80"}`,style:{width:`${c}%`,backgroundColor:l.color,transition:"width 300ms ease"}})})}),e.jsx("div",{className:"w-24 text-right text-sm text-gray-900",children:Number(l.value||0).toLocaleString()})]},r)})})}function C({kpis:a,recentJournals:x,ledgerBalances:i}){const{t:s}=p();return e.jsxs(w,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:s("dashboard")}),children:[e.jsx(f,{title:s("dashboard")}),e.jsxs("div",{className:"mx-auto max-w-7xl p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-5",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("sales_today")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.salesToday})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("sales_this_month")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.salesMonth})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("orders")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.ordersCount})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("products_label")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.productsCount})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("ledger_accounts")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.ledgerAccounts})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("avg_sold_price")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(n,{value:a.avgSoldPrice})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("units_original")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.unitsOriginal??0})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("units_discounted")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.unitsDiscounted??0})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("lent_out_units")}),e.jsx("div",{className:"text-2xl font-semibold",children:a.lentOutTotal??0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:s("assets_breakdown")}),e.jsx(v,{data:[{label:s("cash_in_hand"),value:a.cashInHand??0,color:"#22c55e"},{label:s("bank_balance_label"),value:a.bankBalance??0,color:"#3b82f6"},{label:s("receivables_label"),value:a.receivables??0,color:"#a855f7"}],size:200})]}),e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:s("net_overview")}),e.jsx(v,{data:[{label:s("assets"),value:Math.max(0,(a.cashInHand??0)+(a.bankBalance??0)+(a.receivables??0)),color:"#10b981"},{label:s("liabilities"),value:Math.abs(a.payables??0),color:"#ef4444"}],size:200})]}),e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:s("assets")}),e.jsx(N,{data:[{label:s("cash_in_hand"),value:a.cashInHand??0,color:"#16a34a"},{label:s("bank_balance_label"),value:a.bankBalance??0,color:"#2563eb"},{label:s("receivables_label"),value:a.receivables??0,color:"#7c3aed"},{label:s("payables_label"),value:Math.abs(a.payables??0),color:"#dc2626"}]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-5",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("cash_in_hand")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(n,{value:a.cashInHand})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("bank_balance_label")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(n,{value:a.bankBalance})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("receivables_label")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(n,{value:a.receivables})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("payables_label")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(n,{value:a.payables})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("net_profit_month")}),e.jsx("div",{className:`text-2xl font-semibold ${Number(a.netProfitMonth)>=0?"text-emerald-600":"text-red-600"}`,children:e.jsx(n,{value:a.netProfitMonth})})]})]}),e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:s("quick_actions")}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(h,{href:route().has("inventory.loans.index")?route("inventory.loans.index"):"#",className:"inline-flex items-center rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700",children:s("inventory_loans_label")}),e.jsx(h,{href:route().has("inventory.loans.create")?route("inventory.loans.create"):"#",className:"inline-flex items-center rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700",children:s("new_loan")}),e.jsx(h,{href:route().has("reports.sales")?route("reports.sales"):"#",className:"inline-flex items-center rounded bg-slate-700 px-4 py-2 text-white hover:bg-slate-800",children:s("sales_report_label")}),e.jsx(h,{href:route().has("reports.inventory")?route("reports.inventory"):"#",className:"inline-flex items-center rounded bg-slate-700 px-4 py-2 text-white hover:bg-slate-800",children:s("inventory_report_label")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:s("average_sales")}),e.jsx(v,{data:[{label:s("units_original_price"),value:a.unitsOriginal??0,color:"#0ea5e9"},{label:s("units_discounted_price"),value:a.unitsDiscounted??0,color:"#f59e0b"},{label:s("lent_out_units"),value:a.lentOutTotal??0,color:"#10b981"}],size:200})]}),e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:s("price_increase_trend")}),e.jsx(N,{data:[{label:s("sales_this_month"),value:a.salesMonth??0,color:"#2563eb"},{label:s("sales_today"),value:a.salesToday??0,color:"#22c55e"},{label:s("orders"),value:a.ordersCount??0,color:"#f97316"}]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:s("recent_journal_entries")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:s("date_label")}),e.jsx("th",{className:"px-2 py-2 text-left",children:s("memo")}),e.jsx("th",{className:"px-2 py-2 text-right",children:s("action")})]})}),e.jsx("tbody",{children:x?.map(l=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-2 py-2",children:l.date}),e.jsx("td",{className:"px-2 py-2",children:l.memo||"-"}),e.jsx("td",{className:"px-2 py-2 text-right",children:route().has("reports.journals")&&e.jsx(h,{href:route("reports.journals",{from:l.date,to:l.date}),className:"text-indigo-600 hover:underline",children:s("view")})})]},l.id))})]})})]}),e.jsxs("div",{className:"rounded bg-white p-6 shadow",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:s("ledger_balances")}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:i.map((l,r)=>e.jsxs("div",{className:"rounded border p-3",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l.currency}),e.jsx("div",{className:"text-xl font-semibold",children:e.jsx(n,{value:l.total})})]},r))})]})]})]})]})}export{C as default};
