import{j as e,H as T,L as y}from"./app-BY2_RXAK.js";import{A as E}from"./AuthenticatedLayout-Bx35s1Fr.js";import{F as l}from"./FmtCurrency-7ExuUkNR.js";import{F as c}from"./FmtNumber-CtA-tKzs.js";import{F as L}from"./FmtDate-C8qh_Y1F.js";import"./transition-CRMZObkh.js";import"./HelpInjector-CKGuYAzS.js";import"./InfoIcon-CjmUhCtz.js";function W({filters:i,aggregates:r,chart:h,vendorSummary:S=[],productSummary:A=[],purchases:o,options:p={}}){const m=h?.days??i?.days??30,v=h?.labels??[],N=h?.spend??[],g=h?.qty??[],_=920,b=280,a={t:16,r:40,b:40,l:48},n=_-a.l-a.r,d=b-a.t-a.b,x=v.length||1,P=Math.max(1,...N),$=Math.max(1,...g),u=s=>a.l+s*n/Math.max(1,x-1),M=s=>a.t+d-s/P*d,f=s=>a.t+d-s/$*d,k=N.map((s,t)=>`${t===0?"M":"L"} ${u(t)} ${M(s)}`).join(" "),w=Math.min(24,n/Math.max(1,x)*.6),j=({d:s,children:t})=>e.jsx(y,{href:route("reports.purchases",{days:s}),preserveState:!0,preserveScroll:!0,className:`px-3 py-1 rounded border text-sm ${Number(m)===s?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:t});return e.jsxs(E,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800","data-help-key":"purchases_over_time",children:"Purchases Report"}),children:[e.jsx(T,{title:"Purchases Report"}),e.jsxs("div",{className:"mx-auto max-w-6xl p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_total_spend",children:"Total Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:r.totalSpend??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_total_qty",children:"Total Quantity"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(c,{value:r.totalQty??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_avg_unit_cost",children:"Avg Unit Cost"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:r.avgUnitCost??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_outstanding",children:"Outstanding Payables"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:r.outstanding??0})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_avg_daily_spend",children:"Avg Daily Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:r.avgDailySpend??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_avg_daily_qty",children:"Avg Daily Qty"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(c,{value:r.avgDailyQty??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_weekly_avg_spend",children:"Weekly Avg Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:r.weeklyAvgSpend??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_monthly_avg_spend",children:"Monthly Avg Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:r.monthlyAvgSpend??0})})]})]}),e.jsx("div",{className:"rounded bg-white p-4 shadow",children:e.jsxs("form",{method:"get",action:route("reports.purchases"),className:"grid gap-3 md:grid-cols-4",children:[e.jsx("input",{type:"hidden",name:"days",value:m}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Vendor"}),e.jsxs("select",{name:"vendor_id",defaultValue:i?.vendor_id||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:"All vendors"}),p?.vendors?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product"}),e.jsxs("select",{name:"product_id",defaultValue:i?.product_id||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:"All products"}),p?.products?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Status"}),e.jsxs("select",{name:"status",defaultValue:i?.status||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:"Any status"}),p?.statuses?.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"submit",className:"inline-flex items-center rounded bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700",children:"Apply"})})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800","data-help-key":"purchases_over_time",children:"Purchases over time"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{d:7,children:"7d"}),e.jsx(j,{d:14,children:"14d"}),e.jsx(j,{d:30,children:"30d"}),e.jsx(y,{href:route("reports.purchases.export",{days:m,vendor_id:i?.vendor_id||void 0,product_id:i?.product_id||void 0,status:i?.status||void 0}),className:"ml-2 inline-flex items-center gap-2 rounded bg-emerald-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-emerald-700",children:"Export"})]})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow overflow-x-auto",children:[e.jsxs("svg",{viewBox:`0 0 ${_} ${b}`,className:"w-full h-72",children:[e.jsx("line",{x1:a.l,y1:a.t+d,x2:a.l+n,y2:a.t+d,stroke:"#E5E7EB"}),e.jsx("line",{x1:a.l,y1:a.t,x2:a.l,y2:a.t+d,stroke:"#E5E7EB"}),e.jsx("path",{d:`${k} L ${a.l+n} ${a.t+d} L ${a.l} ${a.t+d} Z`,fill:"rgba(99,102,241,0.12)"}),e.jsx("path",{d:k,fill:"none",stroke:"#6366F1",strokeWidth:"2"}),g.map((s,t)=>e.jsx("rect",{x:u(t)-w/2,y:f(s),width:w,height:a.t+d-f(s),fill:"#10B981",opacity:"0.7"},t)),e.jsx("text",{x:a.l-8,y:a.t+10,textAnchor:"end",fontSize:"10",fill:"#6B7280",children:"Spend"}),e.jsx("text",{x:a.l+n+8,y:a.t+10,textAnchor:"start",fontSize:"10",fill:"#6B7280",children:"Qty"}),v.map((s,t)=>x<=12||t%Math.ceil(x/12)===0?e.jsx("text",{x:u(t),y:a.t+d+16,textAnchor:"middle",fontSize:"10",fill:"#6B7280",children:s.slice(5)},t):null)]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-indigo-500"})," Spend"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-emerald-500"})," Quantity"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3","data-help-key":"purchases_top_vendors",children:"Top Vendors"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_vendor",children:"Vendor"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_purchases",children:"Purchases"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_units",children:"Units"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_avg_unit",children:"Avg Unit"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_spend",children:"Spend"})]})}),e.jsx("tbody",{children:S?.map((s,t)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4",children:s.vendor_name}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(c,{value:s.purchases_count})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(c,{value:s.total_qty})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.avg_unit_cost??0})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.total_spend??0})})]},t))})]})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3","data-help-key":"purchases_top_products",children:"Top Purchased Products"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_product",children:"Product"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_units",children:"Units"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_avg_unit",children:"Avg Unit"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_total_cost",children:"Total Cost"})]})}),e.jsx("tbody",{children:A?.map((s,t)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4",children:s.product_name}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(c,{value:s.total_qty})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.avg_unit_cost??0})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.total_cost??0})})]},t))})]})})]})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Detailed Purchases"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_datetime",children:"Date/Time"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_vendor",children:"Vendor"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_items",children:"Items"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_units",children:"Units"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_subtotal",children:"Subtotal"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_tax",children:"Tax"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_other",children:"Other"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_total",children:"Total"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_paid",children:"Paid"}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_status",children:"Status"})]})}),e.jsx("tbody",{children:o?.data?.map(s=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4 whitespace-nowrap",children:e.jsx(L,{value:s.date,options:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}})}),e.jsx("td",{className:"py-2 pr-4",children:s.vendor}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(c,{value:s.items})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(c,{value:s.units})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.subtotal})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.tax_total})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.other_charges})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.grand_total})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(l,{value:s.amount_paid})}),e.jsx("td",{className:"py-2 pr-4",children:s.status||"-"})]},s.id))})]})}),o?.links&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:o.links.map((s,t)=>e.jsx(y,{href:s.url||"#",preserveState:!0,preserveScroll:!0,className:`px-3 py-1 rounded border text-sm ${s.active?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} ${s.url?"":"pointer-events-none opacity-50"}`,dangerouslySetInnerHTML:{__html:s.label}},t))})]})]})]})}export{W as default};
