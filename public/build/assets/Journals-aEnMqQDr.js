import{u as C,r as c,j as e,H as D,L as k}from"./app-BPLSlo03.js";import{T as s}from"./Tooltip-C55n0Qkv.js";import{A as T}from"./AuthenticatedLayout-Cq5jCDel.js";import{f as r}from"./currency-DO5TMxe2.js";import{d as E,B as L,C as S,b as M,L as _,P as $,e as R,c as B,p as F,a as J}from"./index-KumoPgr3.js";import"./transition-wZ_MSpzK.js";S.register(M,_,$,R,B,F,J);function K({auth:b,filters:o,entries:x,aggregates:i}){const j=!o.scope||o.scope==="all"?"revenue":o.scope,{data:a,setData:n,get:g,processing:v}=C({from:o.from,to:o.to,scope:j,account:""}),N=t=>{t.preventDefault();const l={from:a.from,to:a.to},m=a.account?.trim()?`account:${a.account.trim()}`:a.scope;g(route("reports.accounting.journals",{...l,scope:m}),{preserveState:!0})},d=i?.series??[],p=c.useMemo(()=>d.map(t=>t.date),[d]),u=c.useMemo(()=>d.map(t=>Number(t.debit||0)),[d]),h=c.useMemo(()=>d.map(t=>Number(t.credit||0)),[d]),f=c.useMemo(()=>({labels:p,datasets:[{label:"Debit",data:u,borderColor:"#10b981",backgroundColor:"rgba(16,185,129,0.2)",tension:.25},{label:"Credit",data:h,borderColor:"#ef4444",backgroundColor:"rgba(239,68,68,0.2)",tension:.25}]}),[p,u,h]),y=c.useMemo(()=>({labels:["Totals"],datasets:[{label:"Total Debit",data:[Number(i?.totals?.debit||0)],backgroundColor:"#10b981"},{label:"Total Credit",data:[Number(i?.totals?.credit||0)],backgroundColor:"#ef4444"}]}),[i]),w={responsive:!0,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},A={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}};return e.jsxs(T,{user:b.user,children:[e.jsx(D,{title:"Journals"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:["Journals",e.jsx(s,{text:"Shows all journal entries within the selected date range. Each row displays a journal line with its account and debit/credit amounts."})]}),e.jsx(k,{href:route("reports.accounting.journals.export",{from:a.from,to:a.to,scope:a.account?.trim()?`account:${a.account.trim()}`:a.scope}),className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700",children:"Export Excel"})]}),e.jsxs("form",{onSubmit:N,className:"bg-white shadow rounded p-4 grid md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm",children:"From"}),e.jsx("input",{type:"date",className:"mt-1 w-full border-gray-300 rounded",value:a.from,onChange:t=>n("from",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm",children:"To"}),e.jsx("input",{type:"date",className:"mt-1 w-full border-gray-300 rounded",value:a.to,onChange:t=>n("to",t.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm",children:["Scope ",e.jsx(s,{text:"Filter series and aggregates. For meaningful debit vs credit differences, choose Revenue, Expense, Assets, Liabilities, or a specific account code."})]}),e.jsxs("select",{className:"mt-1 w-full border-gray-300 rounded",value:a.scope,onChange:t=>n("scope",t.target.value),children:[e.jsx("option",{value:"revenue",children:"Revenue"}),e.jsx("option",{value:"expense",children:"Expense"}),e.jsx("option",{value:"assets",children:"Assets"}),e.jsx("option",{value:"liabilities",children:"Liabilities"}),e.jsx("option",{value:"all",children:"All (Totals equal by design)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm",children:["Account Code ",e.jsx(s,{text:"Optional. When provided, overrides scope to focus on a single account (e.g., 4000)."})]}),e.jsx("input",{type:"text",placeholder:"e.g., 4000",className:"mt-1 w-full border-gray-300 rounded",value:a.account,onChange:t=>n("account",t.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:v,children:"Apply"})})]}),a.scope==="all"&&!a.account?.trim()&&e.jsx("div",{className:"text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded p-3",children:"Note: With scope = All, double-entry bookkeeping makes total debits equal total credits. Select a specific scope (e.g., Revenue or Expense) or enter an Account Code to see differentiated charts."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-6",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:["Total Debit ",e.jsx(s,{text:"Sum of all debits within range."})]}),e.jsx("div",{className:"text-xl font-semibold",children:r(Number(i?.totals?.debit||0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:["Total Credit ",e.jsx(s,{text:"Sum of all credits within range."})]}),e.jsx("div",{className:"text-xl font-semibold",children:r(Number(i?.totals?.credit||0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:["Lines ",e.jsx(s,{text:"Total journal lines counted."})]}),e.jsx("div",{className:"text-xl font-semibold",children:i?.totals?.lines||0})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:["Avg Daily Debit ",e.jsx(s,{text:"Average debit per day over selected period."})]}),e.jsx("div",{className:"text-xl font-semibold",children:r(Number(i?.averages?.daily?.debit||0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:["Avg Weekly Credit ",e.jsx(s,{text:"Average credit per week over selected period."})]}),e.jsx("div",{className:"text-xl font-semibold",children:r(Number(i?.averages?.weekly?.credit||0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:["Avg Monthly Debit ",e.jsx(s,{text:"Average debit per month over selected period."})]}),e.jsx("div",{className:"text-xl font-semibold",children:r(Number(i?.averages?.monthly?.debit||0))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded shadow p-4",children:[e.jsxs("div",{className:"mb-2 font-medium flex items-center gap-2",children:["Daily Debit vs Credit ",e.jsx(s,{text:"Line chart of total debits and credits per day in range."})]}),e.jsx(E,{data:f,options:w})]}),e.jsxs("div",{className:"bg-white rounded shadow p-4",children:[e.jsxs("div",{className:"mb-2 font-medium flex items-center gap-2",children:["Totals ",e.jsx(s,{text:"Bar comparison of total debit vs total credit."})]}),e.jsx(L,{data:y,options:A})]})]}),e.jsxs("div",{className:"bg-white shadow rounded overflow-x-auto",children:[e.jsxs("div",{className:"px-4 py-2 font-medium flex items-center gap-2",children:["Top Accounts by Activity ",e.jsx(s,{text:"Top accounts by highest debit/credit totals in range."})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Account"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Debit"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Credit"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(i?.topAccounts??[]).map((t,l)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-4 py-2",children:[t.code," ",t.name]}),e.jsx("td",{className:"px-4 py-2 text-right",children:r(Number(t.debit_sum||0))}),e.jsx("td",{className:"px-4 py-2 text-right",children:r(Number(t.credit_sum||0))})]},l))})]})]}),e.jsx("div",{className:"bg-white shadow rounded overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-2 text-left",children:["Date ",e.jsx(s,{text:"Journal entry date."})]}),e.jsxs("th",{className:"px-4 py-2 text-left",children:["Memo ",e.jsx(s,{text:"Short description for the journal entry."})]}),e.jsxs("th",{className:"px-4 py-2 text-left",children:["Account ",e.jsx(s,{text:"Account code and name affected by this line."})]}),e.jsxs("th",{className:"px-4 py-2 text-right",children:["Debit ",e.jsx(s,{text:"Debit amount posted to the account."})]}),e.jsxs("th",{className:"px-4 py-2 text-right",children:["Credit ",e.jsx(s,{text:"Credit amount posted to the account."})]})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x.data.flatMap(t=>t.lines.map((l,m)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:t.date}),e.jsx("td",{className:"px-4 py-2",children:t.memo||"-"}),e.jsx("td",{className:"px-4 py-2",children:l.account?`${l.account.code} ${l.account.name}`:"-"}),e.jsx("td",{className:"px-4 py-2 text-right",children:r(Number(l.debit||0))}),e.jsx("td",{className:"px-4 py-2 text-right",children:r(Number(l.credit||0))})]},`${t.id}-${m}`)))})]})}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Page ",x.current_page," of ",x.last_page]})]})]})}export{K as default};
