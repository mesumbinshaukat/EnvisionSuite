import{u as L,a as C,r as u,j as e,H as F,L as S}from"./app-DUaT__wH.js";import{A as D}from"./AuthenticatedLayout-BRA9NZV-.js";import{L as E,C as A,a as P,b as R,P as H,c as M,d as T,e as $}from"./index-VzF1SlEN.js";import{F as a}from"./FmtCurrency-Bkhx0koK.js";import{F as l}from"./FmtNumber-OnzJea0q.js";import{F as I}from"./FmtDate-BQ2DeFgF.js";import"./transition-7jmKK-Rq.js";import"./HelpInjector-BCvt9IJE.js";import"./InfoIcon-ISLSAj6V.js";A.register(P,R,H,M,T,$);function V({auth:y,filters:p,sales:i,total:_,pricingStats:c,paymentAggregates:g=[],discountsByCustomer:j=[],discountsByProduct:N=[]}){const{t:s,date:o,currency:x,isRTL:h}=L(),{get:v,data:r,setData:m}=C({from:p.from,to:p.to}),b=t=>{t.preventDefault(),v(route("reports.sales"),{preserveState:!0})},f=u.useMemo(()=>{const t=(i.data||[]).reverse(),d=t.map(n=>o(n.created_at,{year:"numeric",month:"short",day:"numeric"})),w=t.map(n=>parseFloat(n.total));return{labels:d,datasets:[{label:s("sales_report"),data:w,borderColor:"#2563eb",backgroundColor:"rgba(37,99,235,0.2)"}]}},[i,o,s]),k=u.useMemo(()=>({maintainAspectRatio:!1,plugins:{legend:{labels:{usePointStyle:!0},align:h?"start":"center"},tooltip:{callbacks:{title:t=>t?.[0]?.label||"",label:t=>`${t.dataset.label?t.dataset.label+": ":""}${x(Number(t.parsed.y??t.parsed))}`}}},scales:{y:{ticks:{callback:t=>x(t)}},x:{ticks:{autoSkip:!0,maxTicksLimit:8}}}}),[x,h]);return e.jsxs(D,{user:y.user,children:[e.jsx(F,{title:s("sales_report")}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-xl font-semibold flex items-center gap-2","data-help-key":"sales_report_title",children:s("sales_report")}),e.jsxs("form",{onSubmit:b,className:"flex gap-2 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 flex items-center gap-2","data-help-key":"sales_filter_from",children:s("date_from")}),e.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:r.from,onChange:t=>m("from",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 flex items-center gap-2","data-help-key":"sales_filter_to",children:s("date_to")}),e.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:r.to,onChange:t=>m("to",t.target.value)})]}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",children:s("apply_label")}),e.jsx(S,{className:"px-4 py-2 bg-green-600 text-white rounded",href:route("reports.sales.export",{from:r.from,to:r.to}),children:s("export_excel_label")})]}),e.jsx("div",{className:"bg-white p-4 rounded shadow",children:e.jsx("div",{className:"h-64",children:e.jsx(E,{data:f,options:k})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsx("div",{className:"text-xs text-gray-500 flex items-center gap-2","data-help-key":"sales_avg_sold_price",children:s("average_sold_price")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(a,{value:c?.avg_sold_price??0})})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsx("div",{className:"text-xs text-gray-500 flex items-center gap-2","data-help-key":"sales_units_original",children:s("units_original_price")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:c?.units_original_price??0})})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsx("div",{className:"text-xs text-gray-500 flex items-center gap-2","data-help-key":"sales_units_discounted",children:s("units_discounted_price")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(l,{value:c?.units_discounted_price??0})})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:g.map(t=>e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsx("div",{className:"text-xs uppercase text-gray-500",children:t.status}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[s("count_label"),": ",e.jsx(l,{value:t.cnt})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[s("paid"),": ",e.jsx(a,{value:t.paid_sum})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[s("total_label")," ",e.jsx(a,{value:t.total_sum})]})]},t.status))}),e.jsxs("div",{className:"bg-white rounded shadow overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase","data-help-key":"sales_th_id",children:s("id")}),e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase","data-help-key":"sales_th_date",children:s("date")}),e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase","data-help-key":"sales_th_customer",children:s("customer_label")}),e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase","data-help-key":"sales_th_type",children:s("type_label")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_th_items",children:s("items")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_th_units",children:s("units")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_th_paid",children:s("paid")}),e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase","data-help-key":"sales_th_payment",children:s("payment")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_th_total",children:s("total")})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(i.data||[]).map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:e.jsx(l,{value:t.id})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(I,{value:t.created_at,options:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}})}),e.jsx("td",{className:"px-4 py-2",children:t.customer_name||s("walk_in")}),e.jsx("td",{className:"px-4 py-2",children:t.customer_type}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(l,{value:t.items_count})}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(l,{value:t.units_count})}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(a,{value:t.amount_paid||0})}),e.jsx("td",{className:"px-4 py-2",children:t.payment_status||"-"}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(a,{value:t.total})})]},t.id))})]}),e.jsxs("div",{className:"p-4 text-right font-semibold",children:[s("total_label")," ",e.jsx(a,{value:_})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded shadow overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 font-semibold","data-help-key":"sales_dc_total_discount",children:s("top_discounts_by_customer")}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase","data-help-key":"sales_dc_customer",children:s("customer_label")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_dc_line_discount",children:s("line_discount")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_dc_header_discount",children:s("header_discount")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_dc_total_discount",children:s("total_discount")})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(j||[]).map((t,d)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:t.customer_name||s("walk_in")}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(a,{value:t.line_discount})}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(a,{value:t.header_discount})}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:e.jsx(a,{value:t.total_discount})})]},d))})]})]}),e.jsxs("div",{className:"bg-white rounded shadow overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 font-semibold","data-help-key":"sales_dp_line_discount",children:s("top_discounts_by_product")}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase","data-help-key":"sales_dp_product",children:s("product_label")}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase","data-help-key":"sales_dp_line_discount",children:s("line_discount")})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(N||[]).map((t,d)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:t.product_name}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(a,{value:t.line_discount})})]},d))})]})]})]})]})]})}export{V as default};
