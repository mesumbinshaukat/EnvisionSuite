import{j as e,H as M,L as u}from"./app-CtQDaI7d.js";import{A as T}from"./AuthenticatedLayout-BmdE4ikK.js";import{f as l}from"./currency-DO5TMxe2.js";import"./transition-TUICTNyj.js";import"./HelpInjector-BfWS8fx6.js";import"./InfoIcon-CwQLPO0h.js";function D({filters:i,aggregates:r,chart:c,vendorSummary:S=[],productSummary:A=[],purchases:o,options:m={}}){const h=c?.days??i?.days??30,y=c?.labels??[],N=c?.spend??[],b=c?.qty??[],g=920,v=280,t={t:16,r:40,b:40,l:48},n=g-t.l-t.r,d=v-t.t-t.b,x=y.length||1,P=Math.max(1,...N),k=Math.max(1,...b),p=s=>t.l+s*n/Math.max(1,x-1),$=s=>t.t+d-s/P*d,f=s=>t.t+d-s/k*d,w=N.map((s,a)=>`${a===0?"M":"L"} ${p(a)} ${$(s)}`).join(" "),_=Math.min(24,n/Math.max(1,x)*.6),j=({d:s,children:a})=>e.jsx(u,{href:route("reports.purchases",{days:s}),preserveState:!0,preserveScroll:!0,className:`px-3 py-1 rounded border text-sm ${Number(h)===s?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:a});return e.jsxs(T,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Purchases Report"}),children:[e.jsx(M,{title:"Purchases Report"}),e.jsxs("div",{className:"mx-auto max-w-6xl p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:l(Number(r.totalSpend??0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Quantity"}),e.jsx("div",{className:"text-2xl font-semibold",children:r.totalQty??0})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Unit Cost"}),e.jsx("div",{className:"text-2xl font-semibold",children:l(Number(r.avgUnitCost??0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Outstanding Payables"}),e.jsx("div",{className:"text-2xl font-semibold",children:l(Number(r.outstanding??0))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Daily Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:l(Number(r.avgDailySpend??0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Daily Qty"}),e.jsx("div",{className:"text-2xl font-semibold",children:Number(r.avgDailyQty??0)})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Weekly Avg Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:l(Number(r.weeklyAvgSpend??0))})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Monthly Avg Spend"}),e.jsx("div",{className:"text-2xl font-semibold",children:l(Number(r.monthlyAvgSpend??0))})]})]}),e.jsx("div",{className:"rounded bg-white p-4 shadow",children:e.jsxs("form",{method:"get",action:route("reports.purchases"),className:"grid gap-3 md:grid-cols-4",children:[e.jsx("input",{type:"hidden",name:"days",value:h}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Vendor"}),e.jsxs("select",{name:"vendor_id",defaultValue:i?.vendor_id||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:"All vendors"}),m?.vendors?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product"}),e.jsxs("select",{name:"product_id",defaultValue:i?.product_id||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:"All products"}),m?.products?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Status"}),e.jsxs("select",{name:"status",defaultValue:i?.status||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:"Any status"}),m?.statuses?.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"submit",className:"inline-flex items-center rounded bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700",children:"Apply"})})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Purchases over time"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{d:7,children:"7d"}),e.jsx(j,{d:14,children:"14d"}),e.jsx(j,{d:30,children:"30d"}),e.jsx(u,{href:route("reports.purchases.export",{days:h,vendor_id:i?.vendor_id||void 0,product_id:i?.product_id||void 0,status:i?.status||void 0}),className:"ml-2 inline-flex items-center gap-2 rounded bg-emerald-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-emerald-700",children:"Export"})]})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow overflow-x-auto",children:[e.jsxs("svg",{viewBox:`0 0 ${g} ${v}`,className:"w-full h-72",children:[e.jsx("line",{x1:t.l,y1:t.t+d,x2:t.l+n,y2:t.t+d,stroke:"#E5E7EB"}),e.jsx("line",{x1:t.l,y1:t.t,x2:t.l,y2:t.t+d,stroke:"#E5E7EB"}),e.jsx("path",{d:`${w} L ${t.l+n} ${t.t+d} L ${t.l} ${t.t+d} Z`,fill:"rgba(99,102,241,0.12)"}),e.jsx("path",{d:w,fill:"none",stroke:"#6366F1",strokeWidth:"2"}),b.map((s,a)=>e.jsx("rect",{x:p(a)-_/2,y:f(s),width:_,height:t.t+d-f(s),fill:"#10B981",opacity:"0.7"},a)),e.jsx("text",{x:t.l-8,y:t.t+10,textAnchor:"end",fontSize:"10",fill:"#6B7280",children:"Spend"}),e.jsx("text",{x:t.l+n+8,y:t.t+10,textAnchor:"start",fontSize:"10",fill:"#6B7280",children:"Qty"}),y.map((s,a)=>x<=12||a%Math.ceil(x/12)===0?e.jsx("text",{x:p(a),y:t.t+d+16,textAnchor:"middle",fontSize:"10",fill:"#6B7280",children:s.slice(5)},a):null)]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-indigo-500"})," Spend"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-emerald-500"})," Quantity"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Top Vendors"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4",children:"Vendor"}),e.jsx("th",{className:"py-2 pr-4",children:"Purchases"}),e.jsx("th",{className:"py-2 pr-4",children:"Units"}),e.jsx("th",{className:"py-2 pr-4",children:"Avg Unit"}),e.jsx("th",{className:"py-2 pr-4",children:"Spend"})]})}),e.jsx("tbody",{children:S?.map((s,a)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4",children:s.vendor_name}),e.jsx("td",{className:"py-2 pr-4",children:s.purchases_count}),e.jsx("td",{className:"py-2 pr-4",children:s.total_qty}),e.jsx("td",{className:"py-2 pr-4",children:l(Number(s.avg_unit_cost??0))}),e.jsx("td",{className:"py-2 pr-4",children:l(Number(s.total_spend??0))})]},a))})]})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Top Purchased Products"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4",children:"Product"}),e.jsx("th",{className:"py-2 pr-4",children:"Units"}),e.jsx("th",{className:"py-2 pr-4",children:"Avg Unit"}),e.jsx("th",{className:"py-2 pr-4",children:"Total Cost"})]})}),e.jsx("tbody",{children:A?.map((s,a)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4",children:s.product_name}),e.jsx("td",{className:"py-2 pr-4",children:s.total_qty}),e.jsx("td",{className:"py-2 pr-4",children:l(Number(s.avg_unit_cost??0))}),e.jsx("td",{className:"py-2 pr-4",children:l(Number(s.total_cost??0))})]},a))})]})})]})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Detailed Purchases"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4",children:"Date/Time"}),e.jsx("th",{className:"py-2 pr-4",children:"Vendor"}),e.jsx("th",{className:"py-2 pr-4",children:"Items"}),e.jsx("th",{className:"py-2 pr-4",children:"Units"}),e.jsx("th",{className:"py-2 pr-4",children:"Subtotal"}),e.jsx("th",{className:"py-2 pr-4",children:"Tax"}),e.jsx("th",{className:"py-2 pr-4",children:"Other"}),e.jsx("th",{className:"py-2 pr-4",children:"Total"}),e.jsx("th",{className:"py-2 pr-4",children:"Paid"}),e.jsx("th",{className:"py-2 pr-4",children:"Status"})]})}),e.jsx("tbody",{children:o?.data?.map(s=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4 whitespace-nowrap",children:s.date}),e.jsx("td",{className:"py-2 pr-4",children:s.vendor}),e.jsx("td",{className:"py-2 pr-4",children:s.items}),e.jsx("td",{className:"py-2 pr-4",children:s.units}),e.jsx("td",{className:"py-2 pr-4",children:l(s.subtotal)}),e.jsx("td",{className:"py-2 pr-4",children:l(s.tax_total)}),e.jsx("td",{className:"py-2 pr-4",children:l(s.other_charges)}),e.jsx("td",{className:"py-2 pr-4",children:l(s.grand_total)}),e.jsx("td",{className:"py-2 pr-4",children:l(s.amount_paid)}),e.jsx("td",{className:"py-2 pr-4",children:s.status||"-"})]},s.id))})]})}),o?.links&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:o.links.map((s,a)=>e.jsx(u,{href:s.url||"#",preserveState:!0,preserveScroll:!0,className:`px-3 py-1 rounded border text-sm ${s.active?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} ${s.url?"":"pointer-events-none opacity-50"}`,dangerouslySetInnerHTML:{__html:s.label}},a))})]})]})]})}export{D as default};
