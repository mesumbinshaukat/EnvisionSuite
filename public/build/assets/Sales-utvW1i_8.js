import{u as b,r as v,j as e,H as f,L as w}from"./app-Bvh6M5M7.js";import{T as s}from"./Tooltip-BuY23-l-.js";import{A as _}from"./AuthenticatedLayout-DTKS6TOL.js";import{d as D,C,b as P,L as S,P as T,e as L,p as k,a as E}from"./index-BEXz0lDj.js";import{f as a}from"./currency-DO5TMxe2.js";import"./transition-BkfdI6g1.js";C.register(P,S,T,L,k,E);function I({auth:o,filters:c,sales:l,total:p,pricingStats:d,paymentAggregates:m=[],discountsByCustomer:h=[],discountsByProduct:u=[]}){const{get:g,data:i,setData:n}=b({from:c.from,to:c.to}),j=t=>{t.preventDefault(),g(route("reports.sales"),{preserveState:!0})},y=v.useMemo(()=>{const t=(l.data||[]).reverse(),r=t.map(x=>new Date(x.created_at).toLocaleDateString()),N=t.map(x=>parseFloat(x.total));return{labels:r,datasets:[{label:"Sales Total",data:N,borderColor:"#2563eb",backgroundColor:"rgba(37,99,235,0.2)"}]}},[l]);return e.jsxs(_,{user:o.user,children:[e.jsx(f,{title:"Sales Report"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:["Sales Report",e.jsx(s,{text:"Sales within the selected date range. Includes walk-in and regular customers, items count, units, and payment status."})]}),e.jsxs("form",{onSubmit:j,className:"flex gap-2 items-end",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 flex items-center gap-2",children:["From ",e.jsx(s,{text:"Start date for the report window."})]}),e.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:i.from,onChange:t=>n("from",t.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 flex items-center gap-2",children:["To ",e.jsx(s,{text:"End date for the report window."})]}),e.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:i.to,onChange:t=>n("to",t.target.value)})]}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Apply"}),e.jsx(w,{className:"px-4 py-2 bg-green-600 text-white rounded",href:route("reports.sales.export",{from:i.from,to:i.to}),children:"Export Excel"})]}),e.jsx("div",{className:"bg-white p-4 rounded shadow",children:e.jsx(D,{data:y})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:["Average Sold Price ",e.jsx(s,{text:"Weighted average of unit selling prices (by quantity) over the period."})]}),e.jsx("div",{className:"text-2xl font-semibold",children:a(Number(d?.avg_sold_price??0))})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:["Units @ Original Price ",e.jsx(s,{text:"Units sold without line-level discount."})]}),e.jsx("div",{className:"text-2xl font-semibold",children:d?.units_original_price??0})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:["Units @ Discounted Price ",e.jsx(s,{text:"Units sold with a discounted unit price."})]}),e.jsx("div",{className:"text-2xl font-semibold",children:d?.units_discounted_price??0})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:m.map(t=>e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsx("div",{className:"text-xs uppercase text-gray-500",children:t.status}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:["Count: ",t.cnt]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:["Paid: ",a(Number(t.paid_sum))]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:["Total: ",a(Number(t.total_sum))]})]},t.status))}),e.jsxs("div",{className:"bg-white rounded shadow overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase",children:"ID"}),e.jsxs("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase",children:["Date ",e.jsx(s,{text:"Sale creation date/time."})]}),e.jsxs("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase",children:["Customer ",e.jsx(s,{text:"Customer name, or Walk-in if not specified."})]}),e.jsxs("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase",children:["Type ",e.jsx(s,{text:"Walk-in vs Regular (has a customer record)."})]}),e.jsxs("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:["Items ",e.jsx(s,{text:"Number of distinct items on the sale."})]}),e.jsxs("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:["Units ",e.jsx(s,{text:"Total units sold across all items."})]}),e.jsxs("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:["Paid ",e.jsx(s,{text:"Amount received for this sale."})]}),e.jsxs("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase",children:["Payment ",e.jsx(s,{text:"Payment status (paid/partial/unpaid)."})]}),e.jsxs("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:["Total ",e.jsx(s,{text:"Gross total including tax."})]})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(l.data||[]).map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:t.id}),e.jsx("td",{className:"px-4 py-2",children:new Date(t.created_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-2",children:t.customer_name||"Walk-in"}),e.jsx("td",{className:"px-4 py-2",children:t.customer_type}),e.jsx("td",{className:"px-4 py-2 text-right",children:t.items_count}),e.jsx("td",{className:"px-4 py-2 text-right",children:t.units_count}),e.jsx("td",{className:"px-4 py-2 text-right",children:a(Number(t.amount_paid||0))}),e.jsx("td",{className:"px-4 py-2",children:t.payment_status||"-"}),e.jsx("td",{className:"px-4 py-2 text-right",children:a(Number(t.total))})]},t.id))})]}),e.jsxs("div",{className:"p-4 text-right font-semibold",children:["Total: ",a(Number(p))]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded shadow overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 font-semibold",children:"Top Discounts by Customer"}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase",children:"Customer"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:"Line Discount"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:"Header Discount"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:"Total Discount"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(h||[]).map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:t.customer_name||"Walk-in"}),e.jsx("td",{className:"px-4 py-2 text-right",children:a(Number(t.line_discount))}),e.jsx("td",{className:"px-4 py-2 text-right",children:a(Number(t.header_discount))}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:a(Number(t.total_discount))})]},r))})]})]}),e.jsxs("div",{className:"bg-white rounded shadow overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 font-semibold",children:"Top Discounts by Product"}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs text-gray-500 uppercase",children:"Product"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs text-gray-500 uppercase",children:"Line Discount"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(u||[]).map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:t.product_name}),e.jsx("td",{className:"px-4 py-2 text-right",children:a(Number(t.line_discount))})]},r))})]})]})]})]})]})}export{I as default};
