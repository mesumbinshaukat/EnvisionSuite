import{r as N,u as g,j as e,H as b,L as p}from"./app-CesMltMj.js";import{A as f}from"./AuthenticatedLayout-B8AMudpm.js";import{C as t}from"./Currency-BcmHof-m.js";import"./transition-DRm8Zbpx.js";function R({customer:r,filters:c={},transactions:i=[],totals:d={}}){const[x,o]=N.useState({}),{data:n,setData:h,get:m,processing:j}=g({from:c.from||"",to:c.to||""}),u=s=>{s.preventDefault(),m(route("customers.ledger",r.id))};return e.jsxs(f,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:["Customer Ledger · ",r.name]}),children:[e.jsx(b,{title:`Customer Ledger — ${r.name}`}),e.jsxs("div",{className:"mx-auto max-w-7xl p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{children:e.jsx(p,{href:route("customers.history"),className:"text-indigo-600 hover:underline",children:"← Back to Customer History"})})}),e.jsxs("form",{onSubmit:u,className:"rounded bg-white p-4 shadow space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"From"}),e.jsx("input",{type:"date",value:n.from,onChange:s=>h("from",s.target.value),className:"w-full rounded border px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"To"}),e.jsx("input",{type:"date",value:n.to,onChange:s=>h("to",s.target.value),className:"w-full rounded border px-3 py-2"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{disabled:j,className:"rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-50",children:"Apply"}),e.jsx(p,{href:route("customers.ledger",r.id),className:"rounded border px-4 py-2",children:"Reset"})]})]}),e.jsx("div",{className:"rounded bg-white p-4 shadow overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-2 py-2 w-8"}),e.jsx("th",{className:"px-2 py-2",children:"Date"}),e.jsx("th",{className:"px-2 py-2",children:"Type"}),e.jsx("th",{className:"px-2 py-2",children:"Reference"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Debit"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Credit"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Balance"})]})}),e.jsxs("tbody",{children:[i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-2 py-6 text-center text-gray-500",children:"No transactions"})}),i.map((s,a)=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-2 py-2 align-top",children:s.type==="sale"&&(s.items||[]).length>0?e.jsx("button",{type:"button",onClick:()=>o(l=>({...l,[a]:!l[a]})),className:"rounded border px-2 text-xs","aria-expanded":!!x[a],children:x[a]?"−":"+"}):null}),e.jsx("td",{className:"px-2 py-2",children:s.date}),e.jsx("td",{className:"px-2 py-2 capitalize",children:s.type}),e.jsx("td",{className:"px-2 py-2",children:s.ref}),e.jsx("td",{className:"px-2 py-2 text-right",children:e.jsx(t,{value:s.debit})}),e.jsx("td",{className:"px-2 py-2 text-right",children:e.jsx(t,{value:s.credit})}),e.jsx("td",{className:`px-2 py-2 text-right ${s.balance>0?"text-red-600":"text-green-600"}`,children:e.jsx(t,{value:s.balance})})]},`row-${a}`),s.type==="sale"&&(s.items||[]).length>0&&x[a]&&e.jsxs("tr",{className:"border-t bg-gray-50",children:[e.jsx("td",{className:"px-2 py-2"}),e.jsx("td",{className:"px-2 py-2",colSpan:6,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-2 py-1",children:"Product"}),e.jsx("th",{className:"px-2 py-1 text-right",children:"Qty"}),e.jsx("th",{className:"px-2 py-1 text-right",children:"Rate"}),e.jsx("th",{className:"px-2 py-1 text-right",children:"Line Total"})]})}),e.jsx("tbody",{children:s.items.map((l,y)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-2 py-1",children:l.product}),e.jsx("td",{className:"px-2 py-1 text-right",children:l.quantity}),e.jsx("td",{className:"px-2 py-1 text-right",children:e.jsx(t,{value:l.price})}),e.jsx("td",{className:"px-2 py-1 text-right",children:e.jsx(t,{value:l.total})})]},y))})]})})})]},`exp-${a}`)]}))]}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"border-t font-semibold",children:[e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2",colSpan:3,children:"Totals"}),e.jsx("td",{className:"px-2 py-2 text-right",children:e.jsx(t,{value:d.debit||0})}),e.jsx("td",{className:"px-2 py-2 text-right",children:e.jsx(t,{value:d.credit||0})}),e.jsx("td",{className:"px-2 py-2 text-right",children:e.jsx(t,{value:d.balance||0})})]})})]})})]})]})}export{R as default};
