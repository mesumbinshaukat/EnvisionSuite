import{u as N,j as e,H as y}from"./app-D_5VtdBN.js";import{A as g}from"./AuthenticatedLayout-C5_-9XrC.js";import{T as k}from"./Tooltip-Cp73JPu_.js";import"./transition-BPfikZ3p.js";function S({customers:m,products:c}){const{data:l,setData:i,post:x,processing:h,errors:o}=N({customer_id:"",payment_method:"cash",items:[]}),u=t=>{const s=c.find(a=>a.id===parseInt(t));s&&i("items",[...l.items,{product_id:s.id,quantity:1}])},p=(t,s)=>{const a=[...l.items],d=a[t],b=c.find(f=>f.id===d.product_id),r=Math.max(0,parseInt(b?.stock??0));let n=parseInt(s)||1;r>0&&n>r&&(n=r),n<1&&(n=1),a[t].quantity=n,i("items",a)},j=t=>{const s=[...l.items];s.splice(t,1),i("items",s)},v=t=>{t.preventDefault(),x(route("pos.checkout"))};return e.jsxs(g,{header:e.jsx("h2",{className:"text-xl font-semibold",children:"Point of Sale"}),children:[e.jsx(y,{title:"POS"}),e.jsx("div",{className:"mx-auto max-w-5xl p-6",children:e.jsxs("form",{onSubmit:v,className:"space-y-4 bg-white p-6 shadow rounded",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Customer"}),e.jsxs("select",{className:"mt-1 w-full rounded border p-2",value:l.customer_id,onChange:t=>i("customer_id",t.target.value),children:[e.jsx("option",{value:"",children:"Walk-in"}),m.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Payment"}),e.jsxs("select",{className:"mt-1 w-full rounded border p-2",value:l.payment_method,onChange:t=>i("payment_method",t.target.value),children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Add Product ",e.jsx(k,{text:"Add items to the cart. Quantity cannot exceed available stock.",children:"i"})]}),e.jsxs("select",{className:"mt-1 w-full rounded border p-2",onChange:t=>u(t.target.value),children:[e.jsx("option",{value:"",children:"Select product"}),c.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.sku,") - Stock: ",t.stock??0]},t.id))]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Product"}),e.jsx("th",{className:"px-2 py-2",children:"Qty"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Available"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:l.items.map((t,s)=>{const a=c.find(d=>d.id===t.product_id);return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-2 py-2",children:a?.name}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"number",min:1,max:Math.max(1,a?.stock??1),className:"w-24 rounded border p-2",value:t.quantity,onChange:d=>p(s,d.target.value),title:`Max ${a?.stock??0} available`})}),e.jsx("td",{className:"px-2 py-2 text-right",children:a?.stock??0}),e.jsx("td",{className:"px-2 py-2 text-right",children:e.jsx("button",{type:"button",onClick:()=>j(s),className:"text-red-600",children:"Remove"})})]},s)})})]})}),o.items&&e.jsx("div",{className:"text-sm text-red-600",children:o.items}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{disabled:h,className:"rounded bg-blue-600 px-4 py-2 text-white",children:"Checkout"})})]})})]})}export{S as default};
