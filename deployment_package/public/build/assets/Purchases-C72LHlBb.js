import{u as B,j as e,H as E,L as _}from"./app-DUaT__wH.js";import{A as F}from"./AuthenticatedLayout-BRA9NZV-.js";import{F as d}from"./FmtCurrency-Bkhx0koK.js";import{F as h}from"./FmtNumber-OnzJea0q.js";import{F as H}from"./FmtDate-BQ2DeFgF.js";import"./transition-7jmKK-Rq.js";import"./HelpInjector-BCvt9IJE.js";import"./InfoIcon-ISLSAj6V.js";function R({filters:i,aggregates:c,chart:x,vendorSummary:$=[],productSummary:q=[],purchases:o,options:m={}}){const{t:a}=B(),u=x?.days??i?.days??30,v=x?.labels??[],N=x?.spend??[],g=x?.qty??[],b=920,f=280,t={t:16,r:40,b:40,l:48},n=b-t.l-t.r,r=f-t.t-t.b,p=v.length||1,L=Math.max(1,...N),M=Math.max(1,...g),j=s=>t.l+s*n/Math.max(1,p-1),A=s=>t.t+r-s/L*r,k=s=>t.t+r-s/M*r,w=N.map((s,l)=>`${l===0?"M":"L"} ${j(l)} ${A(s)}`).join(" "),S=Math.min(24,n/Math.max(1,p)*.6),y=({d:s,children:l})=>e.jsx(_,{href:route("reports.purchases",{days:s}),preserveState:!0,preserveScroll:!0,className:`px-3 py-1 rounded border text-sm ${Number(u)===s?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:l});return e.jsxs(F,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800","data-help-key":"purchases_over_time",children:a("purchases_report")}),children:[e.jsx(E,{title:a("purchases_report")}),e.jsxs("div",{className:"mx-auto max-w-6xl p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_total_spend",children:a("total_spend")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(d,{value:c.totalSpend??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_total_qty",children:a("total_quantity")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(h,{value:c.totalQty??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_avg_unit_cost",children:a("avg_unit_cost")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(d,{value:c.avgUnitCost??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_outstanding",children:a("outstanding_payables")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(d,{value:c.outstanding??0})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_avg_daily_spend",children:a("avg_daily_spend")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(d,{value:c.avgDailySpend??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_avg_daily_qty",children:a("avg_daily_qty")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(h,{value:c.avgDailyQty??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_weekly_avg_spend",children:a("weekly_avg_spend")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(d,{value:c.weeklyAvgSpend??0})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("div",{className:"text-sm text-gray-600","data-help-key":"purchases_monthly_avg_spend",children:a("monthly_avg_spend")}),e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(d,{value:c.monthlyAvgSpend??0})})]})]}),e.jsx("div",{className:"rounded bg-white p-4 shadow",children:e.jsxs("form",{method:"get",action:route("reports.purchases"),className:"grid gap-3 md:grid-cols-4",children:[e.jsx("input",{type:"hidden",name:"days",value:u}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:a("vendor_label")}),e.jsxs("select",{name:"vendor_id",defaultValue:i?.vendor_id||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:a("all_vendors")}),m?.vendors?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:a("product_label")}),e.jsxs("select",{name:"product_id",defaultValue:i?.product_id||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:a("all_products")}),m?.products?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:a("status_label")}),e.jsxs("select",{name:"status",defaultValue:i?.status||"",className:"w-full rounded border-gray-300 text-sm",children:[e.jsx("option",{value:"",children:a("any_status")}),m?.statuses?.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"submit",className:"inline-flex items-center rounded bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700",children:a("apply_label")})})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800","data-help-key":"purchases_over_time",children:a("purchases_over_time")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{d:7,children:"7d"}),e.jsx(y,{d:14,children:"14d"}),e.jsx(y,{d:30,children:"30d"}),e.jsx(_,{href:route("reports.purchases.export",{days:u,vendor_id:i?.vendor_id||void 0,product_id:i?.product_id||void 0,status:i?.status||void 0}),className:"ml-2 inline-flex items-center gap-2 rounded bg-emerald-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-emerald-700",children:a("export")})]})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow overflow-x-auto",children:[e.jsxs("svg",{viewBox:`0 0 ${b} ${f}`,className:"w-full h-72",children:[e.jsx("line",{x1:t.l,y1:t.t+r,x2:t.l+n,y2:t.t+r,stroke:"#E5E7EB"}),e.jsx("line",{x1:t.l,y1:t.t,x2:t.l,y2:t.t+r,stroke:"#E5E7EB"}),e.jsx("path",{d:`${w} L ${t.l+n} ${t.t+r} L ${t.l} ${t.t+r} Z`,fill:"rgba(99,102,241,0.12)"}),e.jsx("path",{d:w,fill:"none",stroke:"#6366F1",strokeWidth:"2"}),g.map((s,l)=>e.jsx("rect",{x:j(l)-S/2,y:k(s),width:S,height:t.t+r-k(s),fill:"#10B981",opacity:"0.7"},l)),e.jsx("text",{x:t.l-8,y:t.t+10,textAnchor:"end",fontSize:"10",fill:"#6B7280",children:a("spend")}),e.jsx("text",{x:t.l+n+8,y:t.t+10,textAnchor:"start",fontSize:"10",fill:"#6B7280",children:a("quantity")}),v.map((s,l)=>p<=12||l%Math.ceil(p/12)===0?e.jsx("text",{x:j(l),y:t.t+r+16,textAnchor:"middle",fontSize:"10",fill:"#6B7280",children:s.slice(5)},l):null)]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-indigo-500"})," ",a("spend")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-emerald-500"})," ",a("quantity")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3","data-help-key":"purchases_top_vendors",children:a("top_vendors")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_vendor",children:a("purchases_th_vendor")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_purchases",children:a("purchases_th_purchases")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_units",children:a("purchases_th_units")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_avg_unit",children:a("purchases_th_avg_unit")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_spend",children:a("purchases_th_spend")})]})}),e.jsx("tbody",{children:$?.map((s,l)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4",children:s.vendor_name}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(h,{value:s.purchases_count})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(h,{value:s.total_qty})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.avg_unit_cost??0})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.total_spend??0})})]},l))})]})})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3","data-help-key":"purchases_top_products",children:a("top_purchased_products")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_product",children:a("product_label")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_units",children:a("purchases_th_units")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_avg_unit",children:a("purchases_th_avg_unit")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_total_cost",children:a("total_cost")})]})}),e.jsx("tbody",{children:q?.map((s,l)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4",children:s.product_name}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(h,{value:s.total_qty})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.avg_unit_cost??0})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.total_cost??0})})]},l))})]})})]})]}),e.jsxs("div",{className:"rounded bg-white p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:a("detailed_purchases")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_datetime",children:a("purchases_th_datetime")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_vendor",children:a("purchases_th_vendor")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_items",children:a("items")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_units",children:a("purchases_th_units")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_subtotal",children:a("purchases_th_subtotal")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_tax",children:a("purchases_th_tax")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_other",children:a("purchases_th_other")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_total",children:a("purchases_th_total")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_paid",children:a("purchases_th_paid")}),e.jsx("th",{className:"py-2 pr-4","data-help-key":"purchases_th_status",children:a("purchases_th_status")})]})}),e.jsx("tbody",{children:o?.data?.map(s=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 pr-4 whitespace-nowrap",children:e.jsx(H,{value:s.date,options:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}})}),e.jsx("td",{className:"py-2 pr-4",children:s.vendor}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(h,{value:s.items})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(h,{value:s.units})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.subtotal})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.tax_total})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.other_charges})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.grand_total})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(d,{value:s.amount_paid})}),e.jsx("td",{className:"py-2 pr-4",children:s.status||"-"})]},s.id))})]})}),o?.links&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:o.links.map((s,l)=>e.jsx(_,{href:s.url||"#",preserveState:!0,preserveScroll:!0,className:`px-3 py-1 rounded border text-sm ${s.active?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} ${s.url?"":"pointer-events-none opacity-50"}`,dangerouslySetInnerHTML:{__html:s.label}},l))})]})]})]})}export{R as default};
